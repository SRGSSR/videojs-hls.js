/*! videojs-hlsjs - v1.2.1 - 2017-01-25*/
!function(a,b,c,d,e){"use strict";var f=b.getComponent("Component"),g=b.getTech("Tech"),h=b.getComponent("Html5"),i=b.options.techOrder.indexOf("html5"),j=b.extend(h,{initHls_:function(){this.hls_=new c(this.options_.hls),this.bindExternalCallbacks_(),this.hls_.on(c.Events.MEDIA_ATTACHED,b.bind(this,this.onMediaAttached_)),this.hls_.on(c.Events.MANIFEST_PARSED,b.bind(this,this.onManifestParsed_)),this.hls_.on(c.Events.LEVEL_SWITCH,b.bind(this,this.onLevelSwitch_)),this.hls_.on(c.Events.ERROR,b.bind(this,this.onError_)),this.el_.addEventListener("error",b.bind(this,this.onMediaError_)),this.forceLevel_=e,this.lastLevel_=e,this.starttime_=-1,this.levels_=[],this.hls_.attachMedia(this.el_)},bindExternalCallbacks_:function(){var a,d=function(a,b,c){var d=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},e=function(a,b){return function(c,d){a(b,d)}},f=b["on"+d(a)];if(f&&"function"==typeof f)return e(f,c)};for(a in c.Events)if(Object.prototype.hasOwnProperty.call(c.Events,a)){var e=c.Events[a],f=d(e,this.options_,this.hls_);f&&this.hls_.on(e,b.bind(this,f))}},onMediaAttached_:function(){this.triggerReady()},currentFragmentTimeRange_:function(){var a;if(this.hls_&&this.hls_.currentLevel>=0){var b=this.hls_.levels[this.hls_.currentLevel].details,c=b.fragments,d=b.isLive,e=c[d?1:0],f=c[d?c.length-3:c.length-1];a={start:e.start,end:f.start+f.duration}}return a?a:{start:0,end:h.prototype.duration.apply(this)}},duration:function(){var a=this.currentFragmentTimeRange_();return a.end-a.start},currentTime:function(){return this.hls_.currentLevel!==this.lastLevel_&&this.trigger("levelswitched"),this.lastLevel_=this.hls_.currentLevel,h.prototype.currentTime.apply(this)},seekable:function(){var a=this.currentFragmentTimeRange_();return{start:function(){return a.start},end:function(){return a.end},length:1}},onManifestParsed_:function(){var a,b,c=!this.options_.disableAutoLevel;this.parseLevels_(),this.levels_.length>0?(this.options_.setLevelByHeight?(a=this.getLevelByHeight_(this.options_.setLevelByHeight),b=!1):this.options_.startLevelByHeight&&(a=this.getLevelByHeight_(this.options_.startLevelByHeight),b=c),c||a&&a.index!==-1||(a=this.levels_[this.levels_.length-1],b=!1)):c||(a={index:this.hls_.levels.length-1},b=!1),a&&(b||this.setLevel(a),this.hls_.startLevel=a.index),this.autoplay()&&this.paused()&&this.play(),this.hls_.startLoad(this.starttime()),this.trigger("levelsloaded")},onLevelSwitch_:function(){this.forceLevel_&&this.hls_.loadLevel!==this.forceLevel_.index&&(this.hls_.loadLevel=this.forceLevel_.index)},getLevelByHeight_:function(a){var b,c;for(b=0;b<this.levels_.length;b++){var d=this.levels_[b],f=Math.abs(a-d.height),g=c,h=g!==e?Math.abs(a-g.height):e;(h===e||h>f)&&(c=this.levels_[b])}return c},parseLevels_:function(){if(this.levels_=[],this.forceLevel_=e,this.hls_.levels){var a;for(this.options_.disableAutoLevel||(this.levels_.push({label:"auto",index:-1,height:-1}),this.forceLevel_=this.levels_[0]),a=0;a<this.hls_.levels.length;a++){var b=this.hls_.levels[a];b.height&&this.levels_.push({label:b.height+"p",index:a,height:b.height})}this.levels_.length<=1&&(this.levels_=[],this.forceLevel_=e)}},setSrc:function(a){this.hls_&&this.hls_.destroy(),this.forceLevel_&&(this.options_.setLevelByHeight=this.forceLevel_.height),this.initHls_(),this.hls_.loadSource(a)},onMediaError_:function(a){var b=a.currentTarget.error;if(b&&b.code===b.MEDIA_ERR_DECODE){var d={type:c.ErrorTypes.MEDIA_ERROR,fatal:!0,details:"mediaErrorDecode"};this.onError_(a,d)}},onError_:function(a,d){var e=[c.ErrorDetails.MANIFEST_LOAD_ERROR,c.ErrorDetails.MANIFEST_LOAD_TIMEOUT,c.ErrorDetails.MANIFEST_PARSING_ERROR];if(e.indexOf(d.details)>=0)b.log.error('HLSJS: Fatal error: "'+d.details+'", aborting playback.'),this.hls_.destroy(),this.error=function(){return{code:3}},this.trigger("error");else if(d.fatal)switch(d.type){case c.ErrorTypes.NETWORK_ERROR:b.log.warn('HLSJS: Network error: "'+d.details+'", trying to recover...'),this.hls_.startLoad(),this.trigger("waiting");break;case c.ErrorTypes.MEDIA_ERROR:var f=function(){this.hls_.startLoad(),this.hls_.off(f)}.bind(this);b.log.warn('HLSJS: Media error: "'+d.details+'", trying to recover...'),this.hls_.swapAudioCodec(),this.hls_.recoverMediaError(),this.hls_.on(c.Events.MEDIA_ATTACHED,f),this.trigger("waiting");break;default:b.log.error('HLSJS: Fatal error: "'+d.details+'", aborting playback.'),this.hls_.destroy(),this.error=function(){return{code:3}},this.trigger("error")}},currentLevel:function(){var a=!this.options_.disableAutoLevel;return this.forceLevel_.index===-1?this.levels_[a?this.hls_.currentLevel+1:this.hls_.currentLevel]:this.forceLevel_},isAutoLevel:function(){return this.forceLevel_.index===-1},setLevel:function(a){this.forceLevel_=a,this.hls_.currentLevel=a.index,this.hls_.loadLevel=a.index},supportsStarttime:function(){return!0},starttime:function(a){return a?void(this.starttime_=a):this.starttime_},getLevels:function(){return this.levels_},dispose:function(){return this.hls_&&this.hls_.destroy(),h.prototype.dispose.apply(this)}});j.isSupported=function(){return c.isSupported()},j.canPlaySource=function(a){return!(b.options.hlsjs.favorNativeHLS&&h.canPlaySource(a))&&a.type&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(a.type)&&c.isSupported()},b.options.hlsjs={favorNativeHLS:!0,hls:{autoStartLoad:!1}},f.registerComponent("Hlsjs",j),g.registerTech("Hlsjs",j),i>-1?b.options.techOrder.splice(i,0,"Hlsjs"):b.options.techOrder.push("Hlsjs")}(window,window.videojs,window.Hls,document);